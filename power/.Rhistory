HighRevCount
}
HighRevCount<-data.frame(City=character(),
review_count=numeric(),
stringsAsFactors=FALSE)
for (i in 1:length(unique(business$cluster))){
CityBus<-subset(business,business$cluster==i)
HighRevCount$City[i]=uc[i]
HighRevCount$review_count[i]=sum(CityBus$review_count>100)
CityRev<-subset(review,review$business_id %in% CityBus$business_id)
a<-sapply(split(CityRev$stars,month(CityRev$date)),mean)
plot(a)
title(main=uc[i])
plot(table((month(CityRev$date))))
title(main=uc[i])
HighRevCount
}
HighRevCount<-data.frame(City=character(),
review_count=numeric(),
stringsAsFactors=FALSE)
for (i in 1:length(unique(business$cluster))){
CityBus<-subset(business,business$cluster==i)
HighRevCount$City[i]=uc[i]
HighRevCount$review_count[i]=sum(CityBus$review_count>100)
CityRev<-subset(review,review$business_id %in% CityBus$business_id)
a<-sapply(split(CityRev$stars,month(CityRev$date)),mean)
plot(a)
title(main=uc[i])
plot(table((month(CityRev$date))))
title(main=uc[i])
HighRevCount
}
source('C:/Users/michael.hunt/Rspace/DASI/Labs/Lab 4 Inference for Numerical Data.R')
by(nc$mage, nc$mature, min)
by(nc$mage, nc$mature, max)
minMAx<-c(by(nc$mage, nc$mature, min),by(nc$mage, nc$mature, max))
minMAx
source('~/.active-rstudio-document')
by(nc$mage, nc$mature, range)
source("http://bit.ly/dasi_inference")
load(url("http://www.openintro.org/stat/data/atheism.RData"))
str(atheism)
us12 = subset(atheism, atheism$nationality == "United States" & atheism$year == "2012")
str(us12)
table(us12$response)
inference(us12$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
.0634-.034
.0634-.0364
(.0634-.0364)/2
n <- 1000
p <- seq(0, 1, 0.01)
me <- 2*sqrt(p*(1 - p)/n)
plot(me ~ p)
spain<-subset(atheism, atheism$nationality == "Spain")
inference(spain$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
?inference
library(OpenIntro)
library(openintro)
?inference
?inference()
inference(spain$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist",grouping="year")
inference(spain$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist",group="year")
inference(spain$response, est = "proportion",group="year", type = "ci", method = "theoretical", success = "atheist")
str(spain)
source('H:/Rspace/DASI/Labs/Lab5 Inf for Categorical data.R')
spain<-subset(atheism, atheism$nationality == "Spain")
inference(data=spain$response,group=spain$year, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
str(spain)
inference(spain$response,spain$year, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
spain<-subset(atheism, atheism$nationality == "Spain")
spain$year<-as.factor(spain$year)
inference(spain$response,spain$year, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
str(spain)
us<-subset(atheism, atheism$nationality == "United States")
us$year<-as.factor(us$year)
str(us)
inference(us$response,us$year, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
39/20
se<-sqrt(p*(1-p)/n)
pnorm(.975,lower.tail=FALSE)
qnorm(.975,lower.tail=FALSE)
qnorm(.975,lower.tail=TRUE)
qnorm((1-conf)/2,lower.tail=FALSE))
me=0.01
conf=0.95
qnorm((1-conf)/2,lower.tail=FALSE))
qnorm((1-conf)/2,lower.tail=FALSE)
(qnorm((1-conf)/2,lower.tail=FALSE)/(2*me))^2
shiny::runApp('H:/Rspace/JHU_Data_Science/JHU_DDP/Project/Shiny')
hl.C14<-5730
x=seq(0,4*hl.C14,100)
y0=1
y=y0*exp(-ln(2)*x/hl.C14)
plot(x,y)
?exp
y0=1
y=y0*exp(-log(2)*x/hl.C14)
plot(x,y)
?line in plot in R
plot(x,y,type="l")
plot(x,y,type="l",color="red")
plot(x,y,type="l",col="red")
plot(x,y,type="l",col="red",lwd=4)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years"
ylab=$N/N_0$)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=$N/N_0$)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N/N_0))
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(dfrac{N}{N_0})
?plotmath
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N%/%N[0])
)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N %/% N[0])
)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N / N[0]))
?abline
?lines
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2)))
hl.C14<-5730
x=seq(0,4*hl.C14,100)
y0=1
y=y0*exp(-log(2)*x/hl.C14)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N / N[0]))
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2))))
lines(c(0,hl.C14),c(y0*exp(-log(2)),y0*exp(-log(2))))
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2))))
library(ggplot2)
h1<-ggplot(data=h1,aes(x=x,y=y))+geom_line()
h1<-data.frame(x,y)
library(ggplot2)
h1<-ggplot(data=h1,aes(x=x,y=y))+geom_
h1<-ggplot(data=h1,aes(x=x,y=y))+geom_line()
h1
lines(c(0,hl.C14),c(y0*exp(-log(2)),y0*exp(-log(2))))
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2))))
h1<-ggplot(data=h1,aes(x=x,y=y))+geom_line(col="red")
h1<-ggplot(data=h1,aes(x=x,y=y))+geom_line(color="red")
h1<-ggplot(data=h1,aes(x=x,y=y),color="red")+geom_line()
h1<-ggplot(data=h1,aes(x=x,y=y),col="red")+geom_line()
h1<-ggplot(data=h1,aes(x=x,y=y,col="red"))+geom_line()
h1<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line()
hl.C14<-5730
x=seq(0,4*hl.C14,100)
y0=1
y=y0*exp(-log(2)*x/hl.C14)
h1<-data.frame(x,y)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N / N[0]))
lines(c(0,hl.C14),c(y0*exp(-log(2)),y0*exp(-log(2))))
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2))))
library(ggplot2)
h1<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line()
h1
h1<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(linewidth=3)
h1<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=3)
hl.C14<-5730
x<-seq(0,4*hl.C14,100)
y0=1
y=y0*exp(-log(2)*x/hl.C14)
h1<-data.frame(x,y)
library(ggplot2)
h1<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=3)
h1
lines(c(0,hl.C14),c(y0*exp(-log(2)),y0*exp(-log(2))))
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2))))
h1<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
hl.C14<-5730
x<-seq(0,4*hl.C14,100)
y0=1
y=y0*exp(-log(2)*x/hl.C14)
h1<-data.frame(x,y)
plot(x,y,
type="l",
col="red",
lwd=4,
xlab="Years",
ylab=expression(N / N[0]))
lines(c(0,hl.C14),c(y0*exp(-log(2)),y0*exp(-log(2))))
lines(c(hl.C14,hl.C14),c(0,y0*exp(-log(2))))
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
h1p
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))
+geom_line(size=2)
+geom_segment(x=c(hl.C14,hl.C14),y=c(0,y0*exp(-log(2))))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))
+geom_line(size=2)
+geom_segment(x=chl.C14,y=0,xend=hl.C14,yend=c(0,y0*exp(-log(2))))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))
+geom_line(size=2)
+geom_segment(x=chl.C14,y=0,xend=hl.C14,yend=y0*exp(-log(2)))
h1p
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)+geom_segment(x=chl.C14,y=0,xend=hl.C14,yend=y0*exp(-log(2)))
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)+geom_segment(x=hl.C14,y=0,xend=hl.C14,yend=y0*exp(-log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
h1p+geom_segment(x=hl.C14,y=0,xend=hl.C14,yend=y0*exp(-log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
h1p<-h1p+geom_segment(x=hl.C14,y=0,xend=hl.C14,yend=y0*exp(-log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
h1p<-h1p+geom_segment(x=hl.C14,y=0,xend=hl.C14,yend=y0*exp(-log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-log(2)),xend=hl.C14,yend=y0*exp(-log(2)))
h1p
n<-1
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
n=2
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
n<-1
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
n=2
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
n<-1
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
n=2
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
n=2
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
n<-1
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
n<-1
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
n=2
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
for (n in 1:3){
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
}
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
for (n in 1:3){
h1p<-h1p+geom_point(x=n*hl.C14,y=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
}
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=2)
for (n in 1:3){
h1p<-h1p+geom_point(x=n*hl.C14,y=y0*exp(-n*log(2)),size=4)
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
}
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=1)
for (n in 1:3){
h1p<-h1p+geom_point(x=n*hl.C14,y=y0*exp(-n*log(2)),size=4)
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)))
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
}
h1p
for (n in 1:3){
h1p<-h1p+geom_point(x=n*hl.C14,y=y0*exp(-n*log(2)),size=4)
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)),colour="blue")
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)))
}
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=1)
for (n in 1:3){
h1p<-h1p+geom_point(x=n*hl.C14,y=y0*exp(-n*log(2)),size=4)
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)),colour="blue")
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)),colour="blue")
}
h1p
library(ggplot2)
h1p<-ggplot(data=h1,aes(x=x,y=y,color="red"))+geom_line(size=1)
for (n in 1:3){
h1p<-h1p+geom_point(x=n*hl.C14,y=y0*exp(-n*log(2)),size=4)
h1p<-h1p+geom_segment(x=n*hl.C14,y=0,xend=n*hl.C14,yend=y0*exp(-n*log(2)),colour="blue",linetype="dashed")
h1p<-h1p+geom_segment(x=0,y=y0*exp(-n*log(2)),xend=n*hl.C14,yend=y0*exp(-n*log(2)),colour="blue",linetype="dashed")
}
h1p
library(ggplot2)
news(Version == "1.0.1", package = "ggplot2")
(3950+2700)*1.2
(4+25.5+15)/(54)
(4+15.5+15)/(54)
library (downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
bwt.nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
bwt.smoke <- filter(babies, smoke==1) %>% select(bwt) %>% unlist
library(dplyr)
bwt.nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
bwt.smoke <- filter(babies, smoke==1) %>% select(bwt) %>% unlist
library(rafalib)
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
set.seed(1)
dat.ns=sample(bwt.nonsmoke,25)
dat.s=sample(bwt.smoke,25)
qnorm(.975)
N<-25
set.seed(1)
dat.ns=sample(bwt.nonsmoke,N)
dat.s=sample(bwt.smoke,N)
diff=dat.s-dat.ns
sd=sd(diff)
qt(.995,2*N-2)
tval<-t.test(dat.ns,dat.s)$statistic
tval
t.test(dat.ns,dat.s)
summ\ry(t.test(dat.ns,dat.s))
summary(t.test(dat.ns,dat.s))
qt(.975,2*N-2)
pt(2.1209,48)
2*pnorm(-abs(tval))
se=sd/sqrt(2*N)
tval<-diff/se
tval
diff=mean(dat.s-dat.ns)
sd=sd(diff)
se=sd/sqrt(2*N)
qt(.995,2*N-2)
qt(.975,2*N-2)
tval<-diff/se
tval
tval<-t.test(dat.ns,dat.s)$statistic
tval
2*pnorm(-abs(tval))
pt(tval,48,lower.tail=FALSE,)
2*pt(tval,48,lower.tail=FALSE,)
2*pnorm(tval,48,lower.tail=FALSE,)
2*pnorm(tval,lower.tail=FALSE,)
2*pnorm(tval,480,lower.tail=FALSE,)
2*pt(tval,480,lower.tail=FALSE,)
2*pt(tval,4800,lower.tail=FALSE,)
qt(.995,48)
2*pnorm(-abs(tval))
pnorm(.995)
qnorm(.995)
## PH525-1x-Week3-Exercises.R
## T-TEST EXERCISES
library(downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
library(dplyr)
bwt.nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
bwt.smoke <- filter(babies, smoke==1) %>% select(bwt) %>% unlist
library(rafalib)
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
set.seed(1)
dat.ns<-sample(bwt.nonsmoke,25)
dat.s<-sample(bwt.smoke,25)
tval<-t.test(dat.ns,dat.s)$statistic
tval
# doing this manually (without t.test
N=25
set.seed(1)
dat.ns <- sample(bwt.nonsmoke , N)
dat.s <- sample(bwt.smoke , N)
X.ns <- mean(dat.ns)
sd.ns <- sd(dat.ns) # note use of sd,not popsd since this is a sample.
X.s <- mean(dat.s)
sd.s <- sd(dat.s)
sd.diff <- sqrt(sd.ns^2/N+sd.s^2/N)
tval <- (X.ns - X.s)/sd.diff
tval
pnorm(tval,lower.tail=FALSE)*2
qnorm(.995)*sd.diff
N<-25
set.seed(1)
dat.ns=sample(bwt.nonsmoke,N)
dat.s=sample(bwt.smoke,N)
X.ns <- mean(dat.ns)
sd.ns <- sd(dat.ns) # note use of sd,not popsd since this is a sample.
X.s <- mean(dat.s)
sd.s <- sd(dat.s)
sd.diff <- sqrt(sd.ns^2/N+sd.s^2/N)
tval <- (X.ns - X.s)/sd.diff
tval
tval<-t.dist(dat.s,dat.ns)
tval
tval<-tdist(dat.s,dat.ns)
tval<-t.dist(dat.s,dat.ns)
?t.
tval<-t.test(dat.s,dat.ns)
tval
2*pt(-abs(tval))
tval<-t.test(dat.s,dat.ns)
tval
2*pt(-abs(tval),48)
tval<-t.test(dat.s,dat.ns)$coefficient
tval
tval<-t.test(dat.s,dat.ns)$statistic
tval
qt(.995,48)*sd.diff
N<-5
set.seed(1)
dat.ns=sample(bwt.nonsmoke,N)
dat.s=sample(bwt.smoke,N)
t.test(dat.s,dat.ns)
library(downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
library(dplyr)
bwt.nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
bwt.smoke <- filter(babies, smoke==1) %>% select(bwt) %>% unlist
library(rafalib)
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
install.packages("yaml")
install.packages("digest")
load(iris)
data("iris")
str(iris)
library(swirl)
rmI(list=ls())
rm(list=ls())
sqrt(4)
swirl()
library(swirl)
swirl()
1
install.packages("UsingR")
library(UsingR)
data("father.son",package="UsingR")
str(father.son)
summary(father.son)
setwd("H:/Rspace/CC-Statistics/power")
