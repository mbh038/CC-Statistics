x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.1)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
myPNG('power_50.png',
1200, 500,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.1)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
myPNG('power_50.png',
1200, 500,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.1)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
myPNG('power_50.png',
1200, 500,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
myPNG('power_50.png',
1200, 500,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
?normTail
myPNG('power_50.png',
1200, 500,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=3)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
myPNG('power_50.png',
1200, 500,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
myPNG('power_50.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
dev.off()
text(8,.22,"n = 50",cex=2.0)
myPNG('power_50.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=100
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
myPNG('power_50.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=50
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
myPNG('power_100.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=100
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
myPNG('power_250.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=250
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
# _____ Variable power _____ #
myPNG('power_500.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=500
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
# _____ Variable power _____ #
myPNG('power_1000.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=1000
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
# _____ Variable power _____ #
myPNG('power_5000.png',
2000, 1000,
mar = c(2.8, 0, 0, 0),
mgp = c(0, 0.45, 0))
#BuildNull(xlim = c(-9, 10))
sd=12
effect=3
n=5000
alpha=.05
power=0.8
se=sqrt(2*sd^2/n)
normTail(-3, 1.071, L = -1000, U = 1000,
df = 50, lwd = 2.5, add = TRUE,
curveColor = COL[2],xlim = c(-8.8, 10),cex.axis=5)
x=seq(-9,9,.1)
y=dnorm(x,-effect,se)
plot(x,y,col = COL[2],lwd=2.5,type="l",xaxp  = c(-9, 9, 6),axes=FALSE)
xshade=seq(-9,-qnorm(1-alpha/2)*se,.01)
yshade=dnorm(xshade,-effect,se)
polygon(c(-9,xshade,-qnorm(1-alpha/2)*se),c(0,yshade,0),col=COL [16])
axis(1, at = seq(-15, 15, 3))
x=seq(-9,9,.1)
y=dnorm(x,0,se)
lines(x,y,col = COL[1],lwd=2.5,xaxp  = c(-9, 9, 6))
mtext(expression(bar(x)[trmt] - bar(x)[ctrl]),
side = 1, line = 1.8)
text(1.2, 0.2, "Null distribution", col = COL[1], pos = 4)
lines(rep(-3, 2), c(0, dnorm(0, 0, 1.70)),
col = COL[2,4], lwd = 0.5)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 3)
segments(-qnorm(1-alpha/2)*se * c(-1, 1), rep(0, 2), y1 = rep(0.15, 2),
col = COL[4], lty = 3, lwd = 1.5)
#text(8,.22,"n = 50",cex=2.0)
dev.off()
qnorm(1-0.05/2)
qnorm(.8)
3-qnorm(1-.05/2)*sqrt(2*12^2/251)
pnorm(-2.1,-3,sqrt(2*12^2/251))
